<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>Betalen</title>
  <link rel="stylesheet" href="betaal.css">
</head>
<body>
  <header>
    <img src="dk-logo.png" alt="DK logo" class="logo">
    <h1>Bestelling afronden</h1>
    <nav>
      <a href="index.html">Home</a>
      <a href="producten.html">Producten</a>
      <a href="winkelmand.html">Winkelmand</a>
      <a href="betaal.html">Betalen</a>
    </nav>
  </header>

  <main>
    <form id="bestelform" action="https://formspree.io/f/xnngwjrb" method="POST">
      <input type="text" name="voornaam" placeholder="Voornaam" required>
      <input type="text" name="achternaam" placeholder="Achternaam" required>
      <input type="email" name="email" placeholder="E-mailadres" required>

      <textarea name="bestelling" id="bestelling" rows="6" readonly></textarea>
      <h3 id="totaal">Totaal: €0.00</h3>

      <button type="submit">Bestelling plaatsen</button>
    </form>
  </main>

  <script>
    const bestellingEl = document.getElementById("bestelling");
    const totaalEl = document.getElementById("totaal");
    const mand = JSON.parse(localStorage.getItem("winkelmand")) || [];

    let totaal = 0;
    let tekst = "";

    mand.forEach(p => {
      totaal += p.prijs;
      tekst += `${p.naam} – €${p.prijs.toFixed(2)}\n`;
    });

    bestellingEl.value = tekst;
    totaalEl.textContent = `Totaal: €${totaal.toFixed(2)}`;

    document.getElementById("bestelform").addEventListener("submit", function() {
      const producten = JSON.parse(localStorage.getItem("producten")) || [];

      mand.forEach(item => {
        const product = producten.find(p => p.id === item.id);
        if (product && product.voorraad > 0) {
          product.voorraad -= 1;
        }
      });

      localStorage.setItem("producten", JSON.stringify(producten));
      localStorage.removeItem("winkelmand");
    });
  </script>
</body>
</html>

